@model IEnumerable<EmployeesDto>
@{
    ViewData["Title"] = "All Employees";
}

<style>
    .employee-card .card {
        border-radius: 20px;
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .employee-card .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px rgba(0,0,0,0.12);
    }

    .employee-card .card-header {
        background-color: #0d6efd;
        color: white;
        text-align: center;
        font-weight: 600;
    }

    .employee-card .badge {
        font-size: 0.85rem;
        margin-top: 5px;
    }

    .employee-card .card-body p {
        margin-bottom: 0.5rem;
        color: #495057;
    }

    .employee-card .btn-sm {
        border-radius: 8px;
    }

    #employeeSearch {
        max-width: 300px;
        border-radius: 10px;
        border: 1px solid #dee2e6;
        transition: all 0.3s ease;
    }

    #employeeSearch:focus {
        border-color: #0d6efd;
        box-shadow: 0 0 0 0.15rem rgba(13,110,253,.15);
    }

    .page-title {
        color: #0d6efd;
        font-weight: 700;
    }
</style>

<div class="container my-5">
    <h2 class="mb-4 text-center page-title">All Employees</h2>

    <div class="d-flex justify-content-between flex-wrap mb-3">
        <a class="btn btn-primary mb-2" asp-controller="Employee" asp-action="Create">
            <i class="fas fa-user-plus me-2"></i>Create Employee
        </a>
        <input id="employeeSearch" type="text" class="form-control w-auto mb-2" placeholder="Search Employee by Name..." />
    </div>

    <div class="row g-4" id="employeesContainer">
        @foreach (var emp in Model)
        {
            <div class="col-md-4 employee-card">
                <div class="card shadow-sm h-100">
                    <div class="card-header">
                        <h5 class="card-title">@emp.Name</h5>
                        <span class="badge @((emp.IsActive) ? "bg-success" : "bg-danger")">
                            @(emp.IsActive ? "Active" : "Inactive")
                        </span>
                    </div>
                    <div class="card-body">
                        <p><strong>Email:</strong> @emp.Email</p>
                        <p><strong>Department:</strong> @(string.IsNullOrEmpty(emp.Department) ? "No Department" : emp.Department)</p>
                        <p><strong>Type:</strong> @emp.EmployeeType</p>
                        <p><strong>Salary:</strong> $@emp.Salary</p>
                        <p><strong>Age:</strong> @emp.Age</p>

                        <div class="d-flex justify-content-between mt-3">
                            <a class="btn btn-success btn-sm" asp-action="Edit" asp-route-id="@emp.Id">
                                <i class="fas fa-edit"></i>
                            </a>
                            <a class="btn btn-info btn-sm" asp-action="Details" asp-route-id="@emp.Id">
                                <i class="fas fa-info-circle"></i>
                            </a>
                            <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteModal-@emp.Id">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Delete Modal -->
                <div class="modal fade" id="deleteModal-@emp.Id" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Delete Employee</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                Are you sure you want to delete <strong>@emp.Name</strong>?
                            </div>
                            <div class="modal-footer">
                                <form asp-action="Delete" asp-controller="Employee" asp-route-id="@emp.Id">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    <button type="submit" class="btn btn-danger">Delete</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        }
    </div>
</div>

@section Scripts{
    <script>
        const searchInput = document.getElementById('employeeSearch');
        const employeeCards = document.querySelectorAll('.employee-card');

        searchInput.addEventListener('keyup', function() {
            const filter = this.value.toLowerCase();
            employeeCards.forEach(card => {
                const name = card.querySelector('.card-title').textContent.toLowerCase();
                card.style.display = name.includes(filter) ? '' : 'none';
            });
        });
    </script>
}
